{{PAGETITLE="Master Merchant"}}
= Under Construction

{{image:under_construction.jpg | under_construction}}

The website is being updated to reflect changes in the images for LibHistoire 2.1.1 and Master Merchant 3.8.x, thus the screenshots, icons, settings menus, and menu descriptions may not mirror those found in-game.

= A bit of light reading

{{image:harry_potter_daniel_radcliffe.gif | harry_potter_daniel_radcliffe }}

Master Merchant is pretty complex. While I try to keep it somewhat simple, you do need to read carefully as this is not just a bit of light reading.

== Contents
{{CONTENTS=3}}

= Features

Master Merchant offers additional features for the Traders of trading guilds. However, the Bonanza module can be used by anyone looking for deals in Tamriel.

## For Players not in a Trading Guild:
Use Bonanza to search for deals. It creates a virtual Auction House of sorts. Searches remain in the Bonanza window for 24 hours. An average price is generated depending on how many of each item you find. However, you will want to filter for items in the Bonanza window to seek out the cheapest price for items found.
* View items purchased from any kiosk (Shopping List)
* View items listed at kiosks you have visited (Bonanza)
* Right click menu to quickly search Bonanza for the item
* Mark writs on the Guild Store menu you can craft (Writ Worthy required)
* Mark items sold for more then the vendor price
## For Trading Guilds:
* See who your Guild's top sellers are and what they are selling
* See your total Guild Sales and Sales Tax income
* Export Sales Report or Sales Activity
## For Trade Guild Members:
* View your personal sales
* View items you have listed for sale
* View your canceled items
* View Guild Sales by other members
* Show sales by total price or price each
* View a ranked report of items sold by other Guild Members
* Deal Calculator flags items at kiosks
   * Use TTC, MM, or Bonanza prices
   * Custom Deal Calculator settings available
   * Sort by Deal Percentage
* Writs are separated by voucher count
* Craft cost added to tooltip, including Potions and Poisons
   * Material Cost for Winter Festival Writs (BETA)
* Autofill a price check into chat to share with other members
* MM automatically saves the last price of any item you list for sale (Awesome Guild Store overrides this feature but provides a similar function)
* View suggested MM price when listing items for sale
* Search any item from any view and filter for specific items
* Toggle to ignore outlier prices (Can be defeated, view documentation)
* Set custom time ranges for SHIFT, CTRL or both.
* Toggle for additional Guild Roster Columns
* Show condensed TTC information in tooltip
   * When using this option it is recommended that you toggle the TTC default tooltip off
* Replace inventory prices with TTC or MM average price (Will affect performance)
   * Toggle whether or not to show the unit price
* Stack Price calculator (Awesome Guild Store overrides this feature but provides a similar function)
* Add sellers to the Guild & Account filter from Graph and some MM UI Views
* Import ATT sales
* Import old MM Sales prior to 06/01/2021
   * Prior to version 3.6.46
* Export Personal Sales or Purchases

{{note: Craft cost will be affected by your skill in Chemistry, Chef, and Brewer.}}

= Guild History UI Overview

## LibHistoire UI

{{image:new_interface_LibHistoire.jpg | new_interface_LibHistoire}}

There is a new interface for LibHistoire and I will be updating more documentation as time permits. The important difference is the Rescan button has been removed and you have a settings button instead.

## Guild History UI

{{image:new_vanilla_interface.jpg | new_vanilla_interface}}

There is a new interface for Guild History. There are arrows for navigating the various pages of guild history and the Show More option only appears when you are on the last page of data.

## Data Is Available

{{image:data_ready_page1.jpg | data_ready_page1}}

If no arrows appear then the data is not ready and this is not a mod error. The server may not have information and ZOS may need to make updates to the game. If reloading the UI does not correct the issue you will have to wait for authors to communicate with ZOS to see if there is a resolution.

## Show More is available

{{image:new_show_more.jpg | new_show_more}}

To request more data you will need to go to the last page available. Then the E Show More option will appear.

= LibHistoire UI

{{image:new_interface_LibHistoire.jpg | libhistoire_popout_menu}}

The new interface has all the new categories from guild hsitory. 

{{image:interface_menu_options.jpg | interface_menu_options}}

There are options to lock and unlock the window to move it and then lock its position.

{{image:libhistoire_popout_menu.jpg | libhistoire_popout_menu}}

Each category has a popout menu that will be explained below.

## Reset Linked Range

This feature should not be used.  I am having a hard time understanding when to use it. 

Here are some reasons not to click it:

* You are missing less than 1 day of data
* You are missing 5 days of data
* You have not played for 2 monts, the ZOS chace was set at 30 days, and you cannot obtain data for 2 months because too much time has passed

LibHistoire is smart enough to know what to do in either case. So it is recomended to not use that option. 

In all cases [[#|Obtaining Guild History]] from the server is the best option and LibHistoire will process the data.

## Clear Cache

This feature will clear the cache stored on your local hard drive. It does not delete any data from the server. Should you want the data from the server again, you would need to manually request it.

## Request Mode

{{image:request_mode_menu.jpg | request_mode_menu}}

Automatic: means data will be requested based on the Addon requesting the data from LibHistoire
Force Off: means data will not be requested whether or not an Addon uses the data
Force On: means data will be requested from the server and kept in the binary cache so that a mod can access it

{{note: LibHistoire automatically requests data from the server and depending on LibHistoire options and features used the requests may be interupdated.}}

= States of the LibHistoire cache

## Unlinked

{{image:red_text_unlinked.jpg | red_text_unlinked}}

In the Unlinked state you can either wait for the server to grant the requests for offline data that LibHistoire requests, or you can manually request guild history for the time you were offline.

## Linking in progress

{{image:yellow_text_linking.jpg | yellow_text_linking}}

Once LibHistoire has what it feels it needs, then it will begin processing the guild history events and attempt to link to the last known event.

## Linking in progress, with 0 events left

{{image:process_stuck.jpg | process_stuck}}

If you ever see it processing 0 events for a while you will just need to wait for the events to link. If there are external factors involved then nothing will process until that is no longer affecting LibHistoire.

## Linked

{{image:green_text_linked.jpg | green_text_linked}}

Once LibHistoire has linked to its stored events you should see green text. This means that LibHistoire has finished processing the guild history.

{{note: You can still request additional history and ask LibHistoire to check the guild history for any missing sales events using the rescan button.}}

= Obtaining Guild History

{{image:request_daily_data.jpg | request_daily_data}}

To obtain sales data the page number and right arrow (or forward arrow) must be showing. You will need to use the arrow to go to the last page of available data. 

{{image:show_more.jpg | show_more}}

Once you have done that the E Show More option will appear. Even if there is no right arrow showing press E to request more data.

{{image:sales_gap_filled.jpg | sales_gap_filled}}

After you have enough guild history to cover the time you have been offline the right arrow will appear. This means you have requested all the missing data. Using the right arrow to go to the end of all the history stored in your binary cache will not request more data from the server. It simply displays the data. You can go all the way to the end if you like but it is not needed.

{{note: If you have not been keeping your data up to date and you have multiple gaps in data the LibHistoire UI will show you and you may need to advance to the next gap and request more data.}}

= Unlinked Events Notification

With LibHistoire 1.2.0 there is a new notification when you log off.

{{image:log_off_notification.jpg | log_off_notification}}

You could have any amount of time that has not been linked with your Guild History Events. If you chose to log off that is fine but pay close attention to the notification. Any gap in information will still be there when you log back in and you will have to take additional steps to obtain any missing sales data.

= Setup Master Merchant 3.0

If you are installing Master Merchant for the first time please follow these steps.

* Install Master Merchant 3.0
* Log In
* Wait for Refresh to finish
* Read the section on [[#|Obtaining Guild History]]

What is described in Obtaining Guild History is how you request  data from the server for use.

== What is required

{{note: You can still use ATT and MM at the same time if you chose. There is a toggle to disable the notification under <font class="purple">Debug Options</font> under the [[#MM Debug Options | MasterMerchat settings]].}}

* Master Merchant 3.7.x
* LibExecutionQueue
* LibGuildStore
* LibGuildStore Data File GS00Data, LibGuildStore Data File GS01Data, etc.
* LibAddonMenu
* LibMediaProvider
* LibGuildRoster
* LibHistoire
* LibAsync
* LibDebugLogger
* LibAlchemy
* LibPrice
* LibItemLink
* LibRecipe

== What to disable when MM is not needed

If you are with a trial group or doing daily writs you may not want MM running in the background to reduce loading times. If you do make sure to disable all of the following.

* Master Merchant 3.7.x
* LibExecutionQueue
* LibGuildStore
* LibGuildStore Data File GS00Data, LibGuildStore Data File GS01Data, etc.

[[sb:Spoiler1 | When Deactivating ]]
{{image:mm_installed_activated.jpg | mm_installed_activated}}
{{image:all_libguildstore_modules.jpg | all_libguildstore_modules}}
[[se:]]

== Importing older Master Merchant Data

{{note: <font class="yellow">Caution</font>, the more data you import the longer MM will need to load.}}

Download [[https://www.esoui.com/downloads/info3334-ImportersforMasterMerchant3.0.html | Importers for Master Merchant 3.0]] which includes all the Master Merchant Data File modules MM00Data, Master Merchant Data File MM01Data, etc. and ShoppingList.

You can import older Master Merchant Data if you have backups for those who like being the library of congress of data. Just know that it will increase load times and the game will take longer to log out as well while saving the data.

{{note: If you are experiencing issues after trying the following steps you can review the section [[#|Alternate Upgrade Method]].}}

### MMxxData modules needed for importing

The MMxxData (MM00Data, MM01Data, etc.) modules are used for importing data only. After your import your data, these old modules should be deactivated.

{{nav:disablemmmodules}}
[[sb:Spoiler2 | Disable MM Modules]]
{{image:disable_mm.jpg | disable_mm}}
[[se:]]

{{note: Because of how saved variables work you have to enable the old MMxxData modules to load the data into memory.}}

== What to expect after you log in for the first time

{{image:startup_refresh.jpg | startup_refresh}}

once you log in the LibHistorie Refresh will start. You will know when the refresh has finished when you see, <font class="yellow">LibGuildStore Refresh Finished</font> appear in the chat window. You will need to obtain guild history data from the server.

Once the initial refresh is finished you can import sales from MM. This is to accommodate people who may have more history in their MM data files then they do in LibHistorie. You can also import from ATT for the same reason. If you have been using ATT and have never used MM then you could have 30 days of data in your ATT data files. After you import your ATT data and do a Ten Day with LibHistorie you will have the most data possible. You can also import purchases from ATT and the old standalone ShoppingList for MM. There will be notifications to disable the old MMxxData modules, the old ShoppingList standalone module, and ATT. There is an option to disable the ATT notification if you prefer to use both MM and ATT at the same time.

= Master Merchant Window

{{image:mm_window.jpg | mm_window}}

{{inline:158px | search_box.jpg | search_box}} Search Box
{{nav:People Icon}}
{{inline:24px | people_icon.jpg | people_icon}} Cycles through: <font class="tan">Seller</font>, All sales totals by Seller. <font class="tan">Item Sold</font>, Top selling ITEMS. <font class="tan">Buyer</font>, All purchase totals by Buyer.
{{nav:Parchment Paper}}
{{inline:24px | open_statistics_window.jpg | open_statistics_window}} Opens the [[#|Statistics Window]].
{{inline:24px | toggle_seller_item.jpg | toggle_seller_item}} <font class="tan">Seller Info</font> Guild Ranks, <font class="tan">Item Info</font> Your Info or All Info.
{{inline:24px | sales_icon.jpg | sales_icon}} <font class="tan">Sales view</font> shows <font class="tan">Personal Sales</font> or <font class="tan">Guild Sales</font>. Use the Seller Info/Guild Ranks toggle to change views from Item Report to Sellers Report.
{{inline:24px | shopping_list.jpg | shopping_list}} The <font class="tan">Shopping List</font> icon allows you to view purchases you have made from guild stores.
{{inline:24px | bonanza_icon.jpg | bonanza_icon}} The <font class="tan">Bonanza</font> icon allows you view trader listings you have seen at other guild stores.
{{inline:24px | reports_icon.jpg | reports_icon}} The <font class="tan">Management</font> view lets you see posted and canceled sales.
{{inline:24px | mail_icon.jpg | mail_icon}} Sends mail to the author with an optional donation amount.
{{inline:24px | money_bag.jpg | money_bag}} The <font class="tan">Moneybag</font> icon means the purchaser is not a member of that guild.

{{note:<font class="tan">Item Sold</font> is only available from a Seller's Report.}}
{{note: Donations should be voluntary. People that struggle to make 25K gold a week, feel free to just say thanks. I'd rather receive a 50K donation from top sellers making millions a week.}}

== Guild Sales and Personal Sales

{{inline:175px | show_your_info.jpg | show_your_info}}{{inline:175px | show_all_info.jpg | show_all_info}}

First select what information you would like to see. <font class="tan">Show Personal Sales</font> will display info ONLY about You. <font class="tan">Show Guild Sales</font> will display data from all members of all of your guilds.

{{note: When the button says <font class="tan">Show Guild Sales</font>, that means you are currently viewing <font class="tan">YOUR</font> information and vice-versa. You can toggle back and forth between <font class="tan">Personal Sales</font> and <font class="tan">Guild Sales</font> while viewing any report.}}

== Item Report

{{image:item_report.jpg | item_report}}

If you have ever opened the Master Merchant window you have probably seen the list of your personal sales. This is an Item Report and if you click the [[#|People Icon]] you will change between the Buyer and the Seller.

### What The Columns Mean

* <font class="tan">Buyer</font>: The purchaser of the item.
* <font class="tan">Guild</font>: The guild associated with the sale of the item.
* <font class="tan">Item Sold</font>: To the left of the Item Sold is the items icon. The number indicates how many of that item was sold.
* <font class="tan">Sale Time</font>: The approximate time the item was sold. The game stores all sales using epoch time so the UI just approximates the sale after the first hour.
* <font class="tan">Price</font>: The price the item sold for. You can view the individual price by clicking the Show Unit Price button.

{{inline:132px | show_unit_price.jpg | show_unit_price}} Toggle between the Unit Price and Total Sale.

== Seller's Report

### Top Buyers and Sellers

{{image:sellers_report_people.jpg | sellers_report_people}}

### Top Items

{{image:sellers_report_items.jpg | sellers_report_items}}

### Personal Sales - Seller's Report

{{image:sellers_report_personal.jpg | sellers_report_personal}}

{{note: You can also view a Seller's Report for your personal sales only the items will be <font class="tan">YOUR</font> top selling items.}}
{{note: Clicking the People Icon will cycle through Seller, Buyer, and Item Sold.}}

### What The Columns Mean

* <font class="tan">Rank</font>: The rank of the member or item for the guild listed. For example, if you are viewing a <font class="tan">seller's</font> report and your rank is <font class="tan">7</font>, it means you are the <font class="tan">7th</font> biggest <font class="tan">seller</font> in the guild for the time selected. If you are viewing an <font class="tan">item</font> report for and <font class="yellow">Dreugh Wax</font> is the <font class="tan">1st</font> item in the list, then <font class="yellow">Dreugh Wax</font> is the <font class="tan">biggest seller</font> for the guild showing.
* <font class="tan">Sales/Purchases</font>: Total Sales or Purchases for that guild or member for the time selected.
* <font class="tan">Tax</font>: Total Tax generated for that guild or member for the time selected.
* <font class="tan">Count</font>: The number on the left is the number of <font class="tan">transactions</font>, while the number on the right is the number of <font class="tan">items</font>. For example @TradingDude had <font class="yellow">10 Dreugh Wax</font> <font class="tan">transactions</font> and sold <font class="yellow">100 Dreugh wax</font> <font class="tan">total</font>.
* <font class="tan">Percent</font>: This shows what percent of total guild sales or purchases each member is responsible for.

== Guild Sales Date Filter Ranges

{{image:filter_time_frames.jpg | time_frames}}

* <font class="tan">Default</font>: Default uses the amount of days for Default set in [[#|Calculation Display Options]]. However, if you open the Master Merchant window while holding a Focus key such as SHIFT, CTRL or both, then opening the window will use the amount of days you set for that Focus.
* <font class="tan">30 Days</font>: 30 Days.
* <font class="tan">30-60 Days</font>: 30 to 60 Days.
* <font class="tan">60-90 Days</font>: 60 to 90 Days.
* <font class="tan">Custom</font>: Custom uses the amount of days set in [[#MasterMerchantWindowOptions | Master Merchant Window Options]]

== Date Ranges

{{image:time_frames.jpg | time_frames}}

There are several date ranges you can choose from. <font class="tan">This Week</font>, <font class="tan">Last Week</font> and <font class="tan">Prior Week</font> start from the ZOS trader flip for the current [[#|Sales Week]]. However, the last option is customizable under the Master Merchant settings under [[#|Calculation Display Options]].

{{note: Days are calculated from midnight and weeks are calculated from each kiosk flip on Tuesday. For example the option <font class="tan">7 Days</font> would be the last 7 days of sales while <font class="tan">Last Week</font> will be from the previous kiosk flip to the most recent kiosk flip. Both of which will be a Tuesday.}}

= Statistics Window

{{image:statistics_window.jpg | statistics_window}}

= Settings

== Master Merchant

=== Master Merchant Window Options

{{image:main_wondow_options.jpg | main_wondow_options}}

* <font class="tan">Open With Mail</font>: Whether or not to open the Master Merchant Window when you open your mail.
* <font class="tan">Open With Store</font>: Whether or not to open the Master Merchant Window when you interact with a guild store.
* <font class="tan">Show Full Sale Price</font>: Show the full price of the sale rather then the amount after the store cut is deducted.
* <font class="tan">Window Font</font>: The font for the Master Merchant Window. You may have other fonts if you have mods that use LibMediaProvider like one of my other mods [[https://www.esoui.com/downloads/info2558-AdvancedNameplatesGreymoor.html | Advanced Nameplates]].
* <font class="tan">Custom Filter Timeframe</font>: The amount of days to use for the Custom dropdown for the [[#|Guild Sales Date Filter Ranges]]

{{note: If you sold a <font class="purple">Crafting Motif 63: Dremora Bows</font> for <font class="yellow">11,000</font> {{inline:20px | currency_gold.png | currency_gold}} the master merchant window will show what you received in the mail which would be <font class="yellow">10,230</font> {{inline:20px | currency_gold.png | currency_gold}}.}}

=== Sales Format Options

Master Merchant provides several ways to view and calculate pricing data based on your current sales history. These options determine how item averages, deal values, sales totals, and other pricing details are processed using the id53 sales data provided by the game's Guild History system.

{{image:dupe_sales_setting.jpg | dupe_sales_setting}}

Use the Sales Format Options menu to choose how pricing is calculated. Each option controls how Master Merchant evaluates your local sales history when determining averages, trends, and suggested prices.

{{note: This option applies to current id53 sales data. If you imported old Master Merchant archives from before Update 41, see [[#|Legacy Data Behavior from Update 41]].}}

=== Time Format Options

{{image:time_format_options.jpg | time_format_options}}

=== Alert Options

{{image:alert_options.jpg | alert_options}}

* <font class="tan">On-Screen Alerts</font>: Show On-Screen popup alerts when you receive a sale. See examples below.
* <font class="tan">Show Alerts in Cyrodiil</font>: Enable or Disable Alerts in Cyrodiil. Useful if you watch for specific PVP alerts and do not want MM Alerts to show up.
* <font class="tan">Chat Alerts</font>: Show chat alerts when you receive a sale. See examples below.
* <font class="tan">Alert Sound</font>: Choose the Alert sound to differentiate it from other mod added Alerts.
* <font class="tan">Show Multiple Alerts</font>: <code>Investigating</code>
* <font class="tan">Offline Sales Report</font>: Show Alerts for sales received while offline. See note.
* <font class="tan">Display Listing Message</font>: Show chat alert when you list an item for sale.

{{note: <font class="tan">Show Multiple Alerts</font> and <font class="tan">Offline Sales Report</font> may not function as intended with the addition of LibHistoire. However, you will still see notifications of sales as they are received.}}

### On-Screen and Chat Alert

{{image:onscreen_alert.jpg | onscreen_alert}}
{{image:chat_alert.jpg | chat_alert}}

=== Calculation Display Options

{{image:tool_tip_settings.jpg | tool_tip_settings}}

<font class="red">WARNING</font>: All sales have already been sorted by the Custom Timeframe at startup. See documentation for more information.

{{note: <font class="tan">Custom Timeframe</font> requires a reload because all of the sales have been placed into all the date ranges as shown in [[#|Date Ranges]] and therefore changing the value means that all the sales would have to be calculated again. This process is difficult to begin with so to avoid any miscalculations (attempting to clear all sales and stats variables) a reload is required.}}

### Timeframes

{{image:calc_display_options_timeframe.jpg | tool_tip_settings}}

For the Custom Timeframe dropdown, Hours, Days, and Weeks are based off of Midnight for the current day. Full Guild Weeks are based off of the current Kiosk Flip.

=== Guild & Account filter

{{image:add_seller_to_filter.jpg | add_seller_to_filter}}

Right click the dots on the graph to add the Seller to the Guild & Account filter.

{{note: There is a limit of 2000 characters for the filter. You will need to manage it from time to time.}}

{{image:ags_menu_filter.jpg | ags_menu_filter}}

You can add the Guild or Seller to the Guild & Account filter from the trader menu with either vanilla or Awesome Guild Store installed.

{{image:filter_from_bonanza.jpg | filter_from_bonanza}}

You can add the Seller to the Guild & Account filter from the Bonanza window.

{{image:vanilla_trader_seller.jpg | vanilla_trader_seller}}

The Seller is located on the tooltip if you do not have Awesome Guild Store installed.

=== Deal Calculator Options

{{image:custom_deal_calc.jpg | custom_deal_calc}}

* <font class="tan">Deal Calculator Type</font>: Choose from MM Average, TTC Average, TTC Suggested, and the Bonanza Price.
* <font class="tan">Modify TTC Suggested Price by 25 percent</font>: When enabled will add 25 percent to the Suggested Price used for the Deal Calculator and the ToolTip. This is the same value as shown in the TTC Tooltip. See the <font class="tan">Modified Suggested Price</font> spoiler below for an example.

{{note: There is no function to check if you set an incorrect value or not. Meaning if <font class="white">Okay Deal Range</font> is <font class="tan">25</font> percent and the <font class="ltgreen">Reasonable Deal Range</font> is <font class="tan">20</font> percent, nothing will tell you that's not going to work. You will need to keep the values in order yourself from lowest to highest.}}

{{nav:modifiedsuggestedprice}}
[[sb:Spoiler3 | Modified Suggested Price]]
{{image:example_ttc_suggested.jpg | example_ttc_suggested}}
[[se:]]

=== Tooltips

{{image:tooltips.jpg | tooltips}}

=== Tooltip Options

{{image:tooltip_options.jpg | tooltip_options}}
{{image-caption:tool_tip_examples.jpg | tool_tip_examples | Tool Tip Examples}}

* <font class="tan">Level/Quality Selectors</font>: Adds Level and Quality selectors to the tooltip window. You can bring up the window by clicking a link in chat or when you right click an item and choose [[#|Popup Item Data]]. See the [[#|Level Quality Selectors]] section for example of the selectors that appear on the tooltip window.

=== Outlier Options

{{image:outlier_options.jpg | outlier_options}}

* <font class="tan">Trim by percentile only</font>: When enabled you can specify the outer percentile to trim from the sales data without using additional outlier removal methods.
* <font class="tan">Percentile</font>: Specify the outer percentile 1 to 15 percent.
* <font class="tan">Ignore Outlier Prices</font>: When enabled MM will use fairly standard methods to remove outliers.
* <font class="tan">Enable Aggressive Restrictions</font>: When enabled additional restrictions will be used when trimming outliers.

=== Price To Chat Options

{{image:price_to_chat.jpg | price_to_chat}}

=== Inventory Options

{{image:inventory_options.jpg | inventory_options}}

* <font class="tan">Modify TTC Suggested Price by 25 percent</font>: When enabled will add 25 percent to the Suggested Price shown in the inventory. This is the same value as shown in the TTC Tooltip. See the <font class="tan">Modified Suggested Price</font> [[#modifiedsuggestedprice | spoiler above]] for an example.

{{image:replace_price.jpg | replace_price}}

=== Guild Store Options

{{image:guild_store_options.jpg | guild_store_options}}
{{image-caption:mm_price_calculator.jpg | mm_price_calculator | Price Calculator when not using AGS.}}
{{image-caption:ags_profit_filter.jpg | ags_profit_filter | AGS Profit filter.}}
{{image-caption:ags_profit_margin.jpg | ags_profit_margin | Profit margin.}}
{{image-caption:ags_display_profit.jpg | ags_display_profit | Your Profit.}}

* <font class="tan">Show Stack Price Calculator</font>: Adds UI to the guild store if you are not using Awesome Guild Store that aids you in setting the stack price of the item listed
* <font class="tan">Save Central Pricing Data</font>: When <font class="yellow">Enabled</font> all pricing data is stored and available to all guilds. When <font class="yellow">Disabled</font> all pricing data is stored separate for each guild.
* <font class="tan">Display Profit Filter</font>: Adds the Profit to the <font class="tan">Time</font> column for the guild store.
* <font class="tan">Display profit instead of margin</font>: Enabled shows the profit value in gold pieces, and disabled shows a percentage.

{{note: The Price Calculator will not show up with Awesome Guild Store. The Profit Filter is AGS only. Adding the profit margin or the total profit will be shown with or without AGS.}}
{{note: Awesome Guild Store uses its own internal pricing routines and only uses the MM Pricing Data when there is not AGS information. Because of that it may appear that the MM pricing data is malfunctioning when it isn't.}}

=== Guild Master Options

{{image:guild_master_options.jpg | guild_master_options}}

=== MM Debug Options

{{image:debug_options.jpg | debug_options}}
{{image-caption:extra_debug_text.jpg | extra_debug_text | Example of extra debug text.}}

* <font class="tan">Activate Custom Debug Logging</font>: The Custom Debug information is really not intended for normal use and should be left disabled.
* <font class="tan">Disable ATT Warning</font>: If you enjoy using both MM and ATT together then please disable the warning that ATT files are active with this toggle.

== LibGuildStore

=== Sales Management Options

{{image:lgs_sales_management.jpg | lgs_sales_management}}

* <font class="tan">Use Sales History Size Only</font>: This will ignore the minimum and maximum count for sales. If there are 4698 sales of an item with the day range selected for retaining data, then the sales will not be trimmed.
* <font class="tan">Minimal Indexing</font>: Does not add search words for items. It only adds the player search word for displaying personal sales. Searching in the Master merchant window is still possible but will take extra time.
* <font class="tan">Sales History Size</font>: The days range to retain data.
* <font class="tan">Min Item Count</font>: The minimum count of sales for a specific item before the days range is considered. If you select 90 days to retain data, but you have seen only 1 sale and the only recorded sale is 120 days old it will not be trimmed.
* <font class="tan">Max Item Count</font>: The maximum count of sales for a specific item before the days range is considered. If you select 90 days to retain data, and you choose 1000, then the oldest sale once the threshold is reached will be trimmed. Meaning if you have 1001 sales for an item, 1 will be trimmed and 1000 will remain.
* <font class="tan">Min Sales Interval</font>: When this value is greater then 0 the Min item count and the sales interval (in Days) will be considered first before truncating. If the interval is set to 10 days and the sale is less then 10 days old the sale will be retained the same as a sale below the Min Item Count.

=== Data Management Options

{{image:lgs_data_management.jpg | lgs_data_management}}

=== LGS Debug Options

{{image:lgs_debug_options.jpg | lgs_debug_options}}

=== Import MM Data

{{image:import_mm_data.jpg | import_mm_data}}

=== Import ATT Data

{{image:import_att_data.jpg | import_att_data}}

=== Import ATT Purchases

{{image:import_att_purchaces.jpg | import_att_purchaces}}

=== Refresh LibHistoire

{{image:refresh_libhistoire.jpg | refresh_libhistoire}}

The Refresh button tells LibHistoire to send all the data from the zos binary cache. The more data in the cache, the longer it will take to transmit.

The refresh button is only a fail safe mechanism in case a user uses a feature that interupts LibHistoire, preventing it from transmitting data to MM. It should not be clicked every so often or every once and a while. Clicking this does not refresh the Master Merchant window or cause the server to send any Guild History.

=== Import ShoppingList Data

{{image:import_shoppinglist_list.jpg | import_shoppinglist_list}}

=== Import Pricing Data

{{image:import_pricing_data.jpg | import_pricing_data}}

=== Reset Data

{{image:reset_data.jpg | reset_data}}

= Shopping List

{{image:shopping_list_view.jpg | shopping_list_view}}

Adds a new icon allowing you to view purchases you make from guild stores.

{{inline:24px | shopping_list.jpg | shopping_list}} The <font class="tan">Shopping List</font> icon allows you to select the installed extension and view purchases you have made from guild stores.

{{note: The by old Shopping List extension by MildFlavour is not longer used and can be disabled after you import your purchases.}}

= Bonanza!

{{image:Bonanza.png | Bonanza}}

Shop all of Tamriel with [[https://www.esoui.com/downloads/info2143-BeamMeUp-TeleporterFastTravel.html | Beam Me Up]] and Bonanza. Master Merchant is not just for high end traders anymore. If you are shopping for the best deal you can find it in the Bonanza window.

{{image:bonanza_window.jpg | bonanza_window}}

With MM 3.7.x the Bonanza {{inline:24px | bonanza_icon.jpg | bonanza_icon}} icon allows you to view items you have seen at traders as you shop for items to purchase.

## Bonanza Name Filter

{{image:bonanza_window_filter.jpg | bonanza_window_filter}}

## Bonanza Type Filter

{{image:bonanza_window_filter_type.jpg | bonanza_window_filter_type}}

## Bonanza - Using BeamMeUp

{{image:bonanza_window_beammeup.jpg | bonanza_window_beammeup}}

{{note: If you have BeamMeUp installed you can right click the Location column to travel to the zone the trader is located in with the usual BeamMeUp restrictions. If there are no players in the zone to jump to BeamMeUp will notify you and you may travel to a wayshrine that is not close to the trader.}}

= Outliers

{{image:less_then_five_outliers.jpg | less_then_five_outliers}}

With only 5 sales the obvious outlier is not ignored.

{{note: There must be at least 6 sales before Master Merchant can ignore outliers.}}

{{image:outlier_ignored.jpg | outlier_ignored}}

With 8 sales of the same item you can see that the obvious outlier is being ignored.

{{note: When ignoring outliers with 6 or more sales that does not mean the highest and lowest sale will be ignored. The lowest and highest price may be well within range and reasonable prices. The above example is a good example to show the remaining 7 are well within tolerance of one another.}}

== Controlling skewed prices

{{note: People will intentionally try to sell items much higher then they are worth. Use the resources available rather then squint at the scatter plot.}}

{{image:bonanza_skewed_prices.jpg | bonanza_skewed_prices}}

While viewing a graph as shown above find out who is skewing the price and add them to the [[#|Guild & Account filter]].

{{image:resolved_skewed_price.jpg | resolved_skewed_price}}

Once the seller is added to the [[#|Guild & Account filter]] you can see that the graph is much more useful.

{{note: The absence of the Bonanza price is not what corrected the graph. The Bonanza average changed because the seller of the item listed for 3000g is being ignored. Other listings of the same item for 200g would not have the same drastic affect as the listing for 3000g.}}

{{image:bonanza_guild_account_filter.jpg | bonanza_guild_account_filter}}

For convenience you can add sellers to the Guild & Account filter from the Bonanza menu.

= MM Price vs TTC vs Bonanza

{{note: These examples demonstrate how MM, TTC, and Bonanza each calculate prices differently. Since Bonanza is newer, the examples help show how to interpret its values. I recommend looking through all of them before making pricing decisions.}}

{{inline:256px | example_1_hlaalu.jpg | example_1_hlaalu}}{{inline:256px | example_2_cuirass.jpg | example_2_cuirass}}{{inline:256px | example_3_bow.jpg | example_3_bow}}{{inline:256px | example_4_plating.jpg | example_4_plating}}

* The MM price is shown in <font class="yellow">yellow text</font>. It is based on actual sales recorded in your guild history. It does not use any TTC information.
* The TTC price comes from their client application. They remove outliers using their own method and calculate an average based on the remaining listings.
* The Bonanza price is shown in <font class="blue">blue text</font>. It is based on the listings you personally saw while checking traders. It reflects what you have encountered yourself, not data from other players.

In the first example with the Hlaalu Bookcase, the Bonanza prices you saw were all in a reasonable range. If most traders offered it around 17K to 19K, that price range is far more reliable than a single inflated listing at 100K.

The second and third examples show how TTC values can differ from what you actually found. When a TTC average includes a wide range of prices, the Bonanza window becomes useful because it shows the listings you personally verified at traders.

Bonanza prices may appear to match TTC at times, but they will vary depending on how many traders you visit and how often the item is listed. Some items appear frequently and require only a few trader visits. Others are uncommon and may need more sampling to get an accurate picture.

You do not need thousands of MM sales to understand a price. Even a few hundred data points for a common item, such as Blessed Thistle, are enough for MM to calculate a stable average.

The same idea applies to the statistical mean. Repeating the same value many times will still lead to the same average. This is known as the Law of Large Numbers, and it explains why a consistent price will stay consistent even when the sample size is moderate.

Pricing does not have to be complicated. Visiting a few traders across different cities is usually enough to identify the normal price range for an item. What matters is demand and how frequently the item appears.

Bonanza has an additional advantage: it shows the listings you actually saw. This helps you choose realistic prices and stay competitive with other guilds without relying on external websites.

While all this information may seem like a lot at first, each tool provides valuable insight. MM, TTC, and Bonanza together give you a complete understanding of the market without needing to leave the game.

## Evaluating the Bonanza price

{{inline:256px | bonanza_tooltip_style_page.jpg | bonanza_tooltip_style_page}}{{inline:512px | low_end_prices.jpg | low_end_prices}}{{inline:512px | high_end_prices.jpg | high_end_prices}}

{{note: If these images appear too small, right click and open them in a new tab to view them at full size.}}

In the first screenshot, the TTC range shows 74K to 93K, while the Bonanza average reflects what you actually saw while visiting traders. When the TTC range is wide or influenced by extreme listings, Bonanza helps verify what you found during your searches.

To evaluate Bonanza correctly, search for the item in the game. For example, you can look up <font class="tan">style zero cuirass</font> in the Bonanza window. This allows you to confirm the prices you have personally seen and compare them to the TTC values.

In the middle image, the listings range from 50K to 125K. By checking several traders, you can quickly see that most listings fall around the middle of that range. It does not require two monitors or outside tools, and it only takes a few minutes to gather reliable results.

From these listings, it is clear that 70K is a realistic average. If you list your item at 70K, you are matching the prices found at the majority of traders you visited. Even if an occasional outlier exists, you are still pricing close to the true market value.

{{note: If the Bonanza price appears higher than your estimate, such as showing 158K instead of 70K, this does not mean it is incorrect. It simply means your sample of traders included higher listings. Always compare the range of prices you saw and make a judgment based on the most common values.}}

## Price Sold vs. Price Listed

The examples above highlight items with unusually large price ranges. These cases help explain the difference between what an item sells for and what players choose to list it for. Anyone can list an item at any price, but that does not mean the item will actually sell at that amount.

The Bonanza and TTC prices are both useful, but they are not the same. Bonanza shows the prices you personally saw at traders, while TTC gives an average after removing outliers. Neither of these values tells you the final sale price unless you combine them with your own observations.

When evaluating an item, think about the intent behind the listings you see. Some players price items very high in the hope that someone will overpay. Others list too low because they want a quick sale. The goal is to find the realistic range where sales actually occur, not the extreme values.

Bonanza helps with this because it lets you compare multiple listings quickly. If most prices fall within a narrow range, that is usually the true value of the item. The extremes on either end are rarely reliable indicators of what the item will sell for.

Keep this in mind when deciding how to price your own items. A high listing does not guarantee a high sale, and a low listing does not mean the market value is low. Use the patterns you see across several traders to determine a fair and accurate price.

## Comparisons between Bonanza, TTC, and MM

{{image:style_page_thurvokun.png | style_page_thurvokun}}

Some players will list an item for an extremely high or unrealistic price. These listings do not reflect the true value of the item and can distort the TTC averages. Ideally the TTC developers would filter out these extreme cases more aggressively, but since they appear in the raw data, items with no consistent history or items that people believe should sell for millions are naturally harder to evaluate.

This section does not focus on those unusable listings. Instead, it looks at situations where TTC, MM, and Bonanza all provide helpful and consistent information.

Below are two examples of the Bonanza price:

{{image:dreugh_wax_bonanza.png | dreugh_wax_bonanza}}

In this example, the Bonanza value is within about 1K of both TTC and the MM average. This shows how closely all three systems can align for commonly traded materials.

{{image:blassed_thistle_bonanza.png | blassed_thistle_bonanza}}

Here, the Bonanza value is only 1 gold away from the TTC average. Even though TTC has thousands of data points for this material, the value is still consistent with what Bonanza shows from the traders you actually visited.

A common misconception is that you need years and years of sales data stored in Master Merchant in order to get accurate results. That is not true. In the Dreugh Wax example, TTC shows more than 15,000 data points, and in the Blessed Thistle example, TTC shows around 2,800. Yet MM is able to show the same price for Blessed Thistle using only a few hundred sale records.

You could demonstrate this with a simple Lua script by adding sets of numbers that average around 100. Even if you mix different values, such as 100, 99, 90, 95, and similar numbers, the average will remain close to the same. No matter how many times you add 100 + 100 + 100, the result does not change.

In statistics this is related to the Mode, the value that appears most often. For commonly sold materials like Chromium Grains, Dreugh Wax, Clam Gall, Blessed Thistle, and others, the data is consistent enough that thousands of points are not required to determine the true average.

Pricing should not be difficult. If you visit three or four cities and check the main traders for key items, you will usually gather enough information to see the normal price range. TTC and Bonanza should agree in most cases, depending on how people choose their listing prices. Some players use the TTC Suggested value, others use the Average value, and it depends on demand and current availability.

Another advantage of Bonanza is that it allows you to view actual listings. As shown earlier in the section [[#Evaluating the Bonanza price | Evaluating the Bonanza price]], you can always verify prices right in the interface. If you see that most traders list a style page for 50K, then 50K is the real going rate. You can then list your item competitively without guessing.

Overall this may seem like a lot of information, but the point is that you do not need extra monitors, external websites, spreadsheets, google docs, or exporting MM data. The Master Merchant interface itself provides everything you need. Using the information on the tooltip makes it fast and easy to compare MM, TTC, and Bonanza prices without leaving the game.

= Misc

== Popup Item Data

{{image:popup_item_data.jpg | popup_item_data}}

This context menu is from having Master merchant and Awesome Guild Store installed. The menu will vary depending on the mods you have installed.

== Level Quality Selectors

I will try to update the selector so that there are graphics to click on but for now it is just text.

The images below show a <font class="purple">Hat of a Mother's Sorrow</font> and the Legendary version does not have buttons on the right because there is no Mythic version. The Epic version has selectors on both the left and right to view the Superior or the Legendary version.

{{note: While the selectors do not seem to be dependant on the sales in your Master Merchant Data, there may be unknown factors that prevent the selector from showing. The code is extremely old and dates back to the introduction of the Champion Points system.}}

<font class="yellow">Hat of a Mother's Sorrow</font>
[[sb:Spoiler4 | Hat of a Mother's Sorrow]]
{{image:ms_legendary.jpg | ms_legendary}}
[[se:]]

<font class="purple">Hat of a Mother's Sorrow</font>
[[sb:Spoiler5 | Hat of a Mother's Sorrow]]
{{image:ms_epic.jpg | ms_epic}}
[[se:]]

== Erroneous timestamp

When you see an erroneous timestamp, LibHistoire will handle this internally. It will not be processed until the timestamp is updated properly by the server.

{{image:1657months.jpg | 1657months}}
{{image:71582789minutes.jpg | 71582789minutes}}

LibHistoire will send the sale to MM after it checks that the erroneous timestamp is no longer present.

== What is being scanned

When LibHistoire is scanning the guild history it is obtaining the sales from all the guild history that you have loaded into memory.

### A few days of sales from 109 entries

{{image:shot_history.jpg | shot_history}}

LibHistoire simply scan entries from the guild history. With another mod installed called <font class="purple">Shissu's Guild Tools</font> a count of the amount of entries is showing. As shown there are 109 entries which only covers a few minutes of sales.

### 4 days of sales from 8031 entries

{{image:long_list.jpg | shot_history}}

However, as shown in the above screen shot there are 8031 entries which covers 4 days of sales. If you feel you are missing sales from 7 days ago then you will need more sales showing on the guild history tab.

== Sales Week

As of  August 11 2020 the kiosk flip is now [[ https://forums.elderscrollsonline.com/en/discussion/540142/updates-to-guild-trader-swap-times/p1 | every Tuesday]]. All sales totals are calculated from the time indicated by ZOS. Refer to the [[ #DateRanges | date ranges ]] section for information on the timeframes.

You should not try to calculate your sales yourself. Each sale is saved with the exact time stamp the sale occurred. All sales even a few seconds prior to the kiosk flip would not show if you selected to see sales from This Week.

{{note:On the day of the kiosk flip sales for This Week will only reset after Zenimax transmits the new kiosk flip time. This can occur several hours after the kiosk flip.}}

= Slash commands

== 3.7.x Sorting Writs by voucher count

{{note: /lgs clean, which is /LGS CLEAN but use lowercase.}}

To reorganize Writs by voucher after upgrading to 3.7.02 you need to use the slash command shown above. After the process is complete you should reload your UI.

{{note: This only applies if you are upgrading from 3.7.01 or earlier.}}

== Export Sales Report

{{image:mm_export_screen.jpg | mm_export_screen}}

Master Merchant can export a general summary of sales for use with spreadsheets. Full disclosure I am not a spreadsheet guru so I can not help with this feature. To use the export feature choose a guild to work with, then select the time and range like This Week or Last Week. Then use <code>/mm export #</code> to export the guild's information. As an example the screen shot shows a 2 for the 2nd guild in your list, therefore the syntax would be <code>/mm export 2</code>.

Once exported the data is saved in <code>MasterMerchant.lua</code> in your <code>SavedVariables</code> folder.

<font class="cyan">Without Taxes:</font>
<pre>
["EXPORT"] = 
{
["version"] = 1,
["YourGuildName"] = 
{
[1] = "@GuildMember&Sales&Purchaces&Rank",
},
</pre>

<font class="cyan">With Taxes:</font>
<pre>
["EXPORT"] = 
{
["version"] = 1,
["YourGuildName"] = 
{
[1] = "@GuildMember&Sales&Purchaces&Taxes&Rank",
},
</pre>

{{note: Taxes is new as of 3.2.7 and you toggle the feature on in addon settings.}}

Since I have never used this feature with a spreadsheet I do not know how easy that is to use as Lua saves it. You may need to copy and paste it into another text file and use regular expressions to clean that up.

{{note: Some of my GMs have explained if this format changed it would break what they currently use so it will not be altered.}}

== Export Sales Activity

{{image:export_sales.jpg | export_sales}}

You would use <code>/mm sales #</code> to export the sales activity. As an example the screen shot shows a 2 for the 2nd guild in your list, therefore the syntax would be <code>/mm sales 2</code>.

Once exported the data is saved in <code>MasterMerchant.lua</code> in your <code>SavedVariables</code> folder.

<pre>
["SALES"] = 
{
["version"] = 1,
["YourGuildName"] = 
{
[1] = "@Ashjunkie&@Lcs_Flores&|H0:item:46129:30:1:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0|h|h&200&1630085615&false&4000&Real Guild Best Guild&Quicksilver Ingot&rr01 white normal materials",
},
</pre>

== Export Personal Sales

{{image:export_personal_sales.jpg | export_sales}}

You would use <code>/mm personal #</code> to export your personal sales. As an example the screen shot shows a 2 for the 2nd guild in your list, therefore the syntax would be <code>/mm personal 2</code>.

Once exported the data is saved in <code>MasterMerchant.lua</code> in your <code>SavedVariables</code> folder.

<pre>
["PERSONALSALES"] = 
{
["version"] = 1,
["GuildName"] = 
{
[1] = "Seller&Buyer&Guild&Quantity&ItemDesc&Price&Timestamp"
},
</pre>

== Export Purchases

{{image:export_purchases.jpg | export_purchases}}

You would use <code>/mm purchases</code> to export your purchases from traders. Only the time dropdown affects the export for purchases.

Once exported the data is saved in <code>MasterMerchant.lua</code> in your <code>SavedVariables</code> folder.

<pre>
["PURCHASES"] = 
{
["version"] = 1,
["data"] = 
{
[1] = "Seller&Buyer&Guild&Quantity&ItemDesc&Price&Timestamp"
},
</pre>

= Troubleshooting

## Duplicate Indexes Detected

{{image:duplicate_indexes_detected.jpg | duplicate_indexes_detected}}

If this notification appears then you either need to cancel and restore a backup or allow Master Merchant to reset all its internal data files and refresh sales data from LibHistorie.

{{note: Your LibHistorie cache will not be reset by accepting to reset Master Merchant data files.}}

## LibGuildStore.lua:316: attempt to index a nil value

<pre>
user:/AddOns/MasterMerchant/Libs/LibGuildStore/LibGuildStore.lua:309: attempt to index a nil value
user:/AddOns/MasterMerchant/Libs/LibGuildStore/LibGuildStore.lua:316: operator < is not supported for nil < number
</pre>

If you have the above error then that means you deactivated Master Merchant but not the rest of the required modules. You need to deactivate all of the GSxxData modules and LibGuildStore. This is mentioned in [[#| What to disable when MM is not needed]]

{{note: If you intend to use Master Merchant and you have the above error then you need to update or activate the required modules for Master Merchant.}}

## Lua errors

There are times when the game for some reason will corrupt GS16Data.lua or GS17Data.lua and when that happens ESO will reset the file. Once that happens nothing about Master Merchant will work with the existing data. You won't be able to open the Master Merchant UI to view sales data or if you hover over the dots on the Graph you will have errors similar to what is shown below.

<pre>
user:/AddOns/MasterMerchant/MasterMerchant_UI.lua:455: operator .. is not supported for string .. nil
user:/AddOns/MasterMerchant/MasterMerchant_UI.lua:458: operator .. is not supported for string .. nil
user:/AddOns/MasterMerchant/MasterMerchant_UI.lua:573: operator .. is not supported for string .. nil
user:/AddOns/MasterMerchant/MasterMerchant_UI.lua:970: operator .. is not supported for string .. nil
user:/AddOns/MasterMerchant/Libs/LibGuildStore/Data.lua:337: attempt to index a nil value
</pre>

While in game go to the LibGuildStore settings menu and look for the heading [[#Reset Data | Reset LibGuildStore ]].

After you click the <font class="ltblue">Reset LibGuildStore Data</font> button the UI will reload and Master Merchant will get information from the LibHistoire cache. After the UI reloads about every minute you will see that Master Merchant is still refreshing data. There will be an approximated time remaining that will go up and down because it's not perfect.

{{note: Do not log out, do writs, open a guild trader, update LibHistorie data, or do anything else until the refresh is complete. Do nothing except maybe move enough or type in guild chat so you don't go AFK.}}

## OneDrive

OneDrive is great for many reasons however, for ESO it can create a situation where the GS16Data.lua and GS17Data.lua files are not synced properly. I would think this would affect any of the GSxxData.lua saved variable files because of their size. They may not syncronize quickly with some internet users because of upload and download speeds being limited. To resolve this you need to change settings so that OneDrive will no longer try to backup your Documents folder where all your Addons and SavedVariables file are located.

{{note: I will admit I do not have Windows 10 or Windows 11 so this is peiced together from helping someone.}}

{{image:onedrive_cloud_icon.jpg | onedrive_cloud_icon}}

First open the OneDrive settings by clicking the Cloud icon for OneDrive.

{{image:manage_backup_button.jpg | manage_backup_button}}

Click the Manage Backup button.

{{image:onedrive_folders_to_backup.jpg | onedrive_folders_to_backup}}

As shown in the above screen shot all three folders are being monitored by OneDrive. You want to disable the backup for the Documents folder.

{{image:onedrive_documents_folders_disabled.jpg | onedrive_documents_folders_disabled}}

Now OneDrive will no longer try to backup the Documents folder.

{{image:onedrive_folders_where_to_backup.jpg | onedrive_folders_where_to_backup}}

If prompted, chose <font class="yellow">This Computer Only</font> so that OneDrive will not attempt to backup your Documents folder.

{{note: You do not have to pay for OneDrive or update to get more space. If you have any issues pausing or stoping OneDrive so that you can change the settings just wait longer until it pauses or stops. It may take a while but it will happen.}}

= Technical Information

== Backup LibGuildStore Data

{{image:lgs_data_backup.jpg | lgs_data_backup}}

To backup your LibGuildStore data you will need to navigate to the SavedVariables folder. Usually <code>C:\Users\Your User Name\Documents\Elder Scrolls Online\live</code>. The files can be easily found going to MyDocuments in windows first. 

{{note: I am sorry I don't know where it is located on a Mac.}}

Once you are in the SavedVariables folders, you will need to copy the 18 <code>GSxxData</code> files named <code>GS00Data.lua</code> to <code>GS17Data.lua</code> as shown in the screen shot. Copy these to a separate folder outside of SavedVariables and do not place them in a subfolder under SavedVariables. You will also want to keep a copy of <code>LibGuildStore.lua</code>, <code>LibHistoire.lua</code>, and <code>MasterMerchant.lua</code>.

== Locating LibExecutionQueue

LibExecutionQueue is included with Master Merchant as shown in the zip below.

{{image:leq_included.jpg | leq_included}}

LibExecutionQueue is sorted alphabetically by the base game.

{{image:leq_unsorted.jpg | leq_unsorted}}

If you have LibVotansAddonList installed then it will look close to the base game.

{{image:leq_votans_sort.jpg | leq_votans_sort}}

== Unintentional ZOS Bug

{{image_thumbnail:savedvarsapostrophe.jpg | savedvarsapostrophe}}

Unfortunately from time to time ZOS introduces or reintroduces a bug in the saved vars where the apostrophe is converted to HTML code. Which will mean your sales may or may not display properly. Which is a game bug and you are out of luck until or unless they fix it.

Since this can occur I highly recommend changing your user name to only contain letters as it will make it easier for you in the long run.

This also includes creative names that contain things like  or . As those are not individual letters.

= Version History

Apparently for version 2.2.0 there was an experimental turbo mode added to MM. From the change log it appears that this was removed by request from Zenimax. However, even I noticed when you tried to download 2.2.1 which had turbo mode removed, you received a file named <font class="purple">Master Merchant 2.2.0.zip</font>. If you tried to engage turbo mode it was still available even if it didn't work as expected.

Aug 01 2020 after the kiosk flip was announced Philgo68 posted that he would be uploading a new version, which would be 2.3.1. From the start it had a small bug in it that prevented it from working. Then after that was fixed people started reporting that the Master Merchant window would not update when you were viewing your personal sales but that all guild sales was still updating properly.

Upon examination of the code 2.3.1 had turbo mode removed which was not really removed in 2.2.1 (2.2.0). In addition to that on the description page it was mentioned that there was Simple Indexing and Simple Scanning. Oddly those options included new options in the Addons menu to toggle the features on and off. These options were not present in 2.2.1.

This makes me believe that 2.3.1 was really intended to be the proposed 2.2.1 but somehow the upload never went through properly. I am glad Philgo68 uploaded the version as it has helped me understand the code a bit more.

= Deprecated

== Legacy Data Behavior from Update 41

During Update 41 (March 2024), Zenimax reset the Guild History server database and switched from id64 to id53 sales identifiers. Because of this reset, Master Merchant could not deduplicate sales across the boundary between pre-U41 id64 data and the new id53 format.

{{note: If you still have archived Master Merchant data from before Update 41 (March 2024), be aware that mixed id64/id53 records cannot be deduplicated. This does not affect users who started fresh after Update 41.}}

### Impact on Users During Update 41

During the transition to Update 41, most users experienced little to no disruption because their binary cache already contained recent sales data. Players who typically retained only 30 to 90 days of history saw minimal data loss, and Guild Masters were still able to evaluate recent weekly activity without issue.

However, users with extensive archival data, years of sales or "library of congress"-style collections, experienced inaccurate averages when mixed id64 and id53 records overlapped. Because the identifier formats could not be matched across the Update 41 boundary, Master Merchant was unable to reliably deduplicate these overlapping records.

This behavior is now legacy and only applies to users who retained significant pre-U41 archived data.

### Bricked Guild Trader / Stuck History Segments

During Update 41 there was also a bug in the base game where the Guild History could become "bricked" when the server pushed new events that could not be merged with the user's already-cached data. This occurred when the cache contained two segments that were supposed to join, but the server reported them as touching with no events in between. When this happened:

* The history bar showed a blue/green segment nearly touching a red segment.
* "Show More" stopped appearing on the last page.
* The player could not advance the trader history.
* Reloading the UI did not resolve it.

{{image:bricked_trader.jpg | bricked_trader}}

Because this bug came from the base game and not addons, it may still occur if the server pushes guild history segments that cannot be merged with your local cache. If this happens, you can use the [[#|Clear Cache]] option in the LibHistoire UI to rebuild your local history data. This will clear the affected cache entries and automatically reload the UI.

== Background Scanning

As of version 3.0.0 there is no <code>/mm missing</code> and no background scan. The background scan would get hung up by repeated attempts to request more sales data from the server. When the server denied the request MM would continue to wait for the request to be approved.

After starting a new library [[https://github.com/ESOUIMods/LibGuildHistoryCache | LibGuildHistoryCache]] I observed that the cache mod would see some new sales. Usually there were only a few sales maybe 1 or 2 and occasionally less then 10. The cache mod would update showing that the guild history events were not duplicates but MM would not see them as new sales. 

One other calculation previous versions of MM made was to try and get the first entry in the guild history and the last. This was used to attempt to determine whether or not to scan from the start of the guild history array, or the end. Whether or not you have 1, 100, or more then 1000 events the first event will always be the same. All guild history events are appended onto the end of the list.

For reasons like these MM no longer uses a background scan as it attempted to scan from a specific point in time and loop over the guild history events.

== Backup Master Merchant 2.x Data

{{note: This backup procedure is exclusively intended for version 2.x or for maintaining a historical backup for importing into 3.x.}}

{{image:mm_data_backup.jpg | mm_data_backup}}

To backup your Master Merchant data you will need to navigate to the SavedVariables folder. Usually <code>C:\Users\Your User Name\Documents\Elder Scrolls Online\live</code>. The files can be easily found going to MyDocuments in windows first. 

{{note: I am sorry I don't know where it is located on a Mac.}}

Once you are in the SavedVariables folders, you will need to copy the 17 MMxxData files named MM00Data.lua to MM16Data.lua as shown in the screen shot. Copy these to a separate folder outside of SavedVariables and do not place them in a subfolder under SavedVariables.

== Uninstall Master Merchant 2.x

{{note: For historical reference, as of August 2020, it was expected that users would have already updated to version 3.x, rendering this procedure unnecessary.}}

[[sb:Spoiler6 | Uninstall 2.x]]
Currently there is some confusion about how to uninstall Master merchant 2.x and install 3.x. First you need to open minion. If you see both versions installed as shown below, uninstall both. The reason you uninstall both is because MM 3.x is a continuation of 2.x. It is the same mod with the same file names and the same folder names. Minion will not understand how to handle this.

{{image:both_mm_installed.jpg | both_mm_installed}}

If you manually install your mods, of if you want to know which folders belong to Master merchant, click the spoiler.

[[sb:Spoiler7 | Master Merchant Folders]]
{{image-caption:mm_files_installed.jpg | mm_files_installed | To see a larger image, right click the image and choose View Image.}}
[[se:]]

{{image:mm_remove_mod.jpg | mm_remove_mod}}

When using Minion to uninstall Master Merchant right click and choose Uninstall.

{{image:mm_remove_mod_caution.jpg | mm_remove_mod_caution}}

Do not check that box or it will remove your MM data files! Only click Delete!

{{image:mm_uninstalled.jpg | mm_uninstalled}}

As you see above, both versions of Master merchant are now uninstalled.

{{note: You have to close Minion because it will be confused about uninstalling both versions.}}

{{image:search_for_mm.jpg | search_for_mm}}

Open Minion again and click Find More and search for <code>Master Merchant 3.0</code> as shown above. Make sure the author's name is Sharlikran. Then click the Install button.

{{note: As noted on the description page you need to install LibAddonMenu, LibMediaProvider, LibGuildRoster, and LibHistoire.}}

I won't be showing how to install all the required libraries. If you need examples images of the two new libraries LibGuildRoster, and LibHistoire click the spoiler.

[[sb:Spoiler8 | New Libraries]]
{{image-caption:install_LibGuildRoster.jpg | install_LibGuildRoster | To see a larger image, right click the image and choose View Image.}}

{{image-caption:install_LibHistoire.jpg | install_LibHistoire | To see a larger image, right click the image and choose View Image.}}
[[se:]]

{{image:one_mm_only.jpg | one_mm_only}}

After you install Master Merchant 3.0 verify it is the only Master Merchant showing in Minion.
[[se:]]

== Alternate Upgrade Method

{{note: Due to Update 41 and LibHistoire 2.x, this procedure is no longer possible.}}

[[sb:Spoiler9 | Alternate Method]]
Thanks to Shadowshire for sharing this workaround. While I did alter most of the steps I wanted to preserve his suggestion because it could provide a good alternative to importing LibHistoire data for those experiencing issues.

This alternate method will primarily use data from the old Master Merchant Data files located in SavedVariables as shown in the deprecated section, [[#|Backup Master Merchant Data]].

It is recommended that only Master Merchant 3.7.x, ShoppingList (older standalone version), the original MMxxData modules, LibGuildStore, all GSxxData modules, and the required library files for Master Merchant are enabled to avoid potential interference while this procedure is performed.

{{note: It is recommended to store any backup copies of Master Merchant data outside of SavedVariables in its own folder. For example <font class="purple">.\Documents\Elder Scrolls Online\live\Backups\MM_Backup_01</font>}}

## Optional Mods For This Procedure
* [[https://www.esoui.com/downloads/info1161-CirconiansAddonSelector.html | Circonians Addon Selector]]

Circonians Addon Selector will allow you to save your current active mods before performing this procedure.

## Optional Debug Settings

The sticky post for Master Merchant 3.0 mentions some slash commands for LibDebugLogger. When these settings are changed this helps provide additional debug information in the event of any errors. Only use these slash commands as a precaution if you have been having issues upgrading.

<pre>
/debuglogger stack on
/debuglogger level debug
</pre>

{{note: You should see a confirmation of each command in the chat window. For users with chat mods installed check your mods settings. System might be redirected to other tabs such as Zone chat.}}

## The Procedure

During this procedure Master Merchant will check for duplicate sales. Please remember it is recommended that you exit the game before you install any add-on or alter the SavedVariables folder.

{{note: Version 3.7.x will not alter the previous MMxxData files or any purchase data for the older standalone ShoppingList module. If you are concerned about loosing any data then please backup your MM file as shown under [[#|Backup Master Merchant Data]]. Purchase data for the standalone ShoppingList module is located in the same folder as the Master Merchant data files in SavedVariables under the name ShoppingList.lua.}}

Remove the data file LibHistoire.lua from the SavedVariables folder. If you did not make a backup it is recommended you move the file to another location where you can find it. Depending on the results of this procedure you may want to restore it even though the primary focus is to use the older MMxxData files.

Verify you have the most recent version of Master Merchant 3.0 installed.

Log in and from the character selection screen click the dropdown for All Characters. Choose a character from the dropdown. This will be the character you log into when performing the procedure. Reduce the amount of mods running by unchecking only [[#What is required | what is required]].

{{note: If you have Circonians Addon Selector installed you will be able to enable all your preferred mods after all your data is imported.}}

After you log in and the user interface is shown, you should see Chat messages displayed by LibGuildStore and by Master Merchant, followed by one or more of the message "LibGuildStore Refresh Not Finished Yet".  Wait for until you see Master Merchant Initialized and the total Sales, Purchases, Listings, and Posted and Canceled items that are being retained.

Press ESC and go to Settings then LibGuildStore to verify that the [[#|Sales Management Options]] are configured to meet your personal preferences.

Further down under LibGuildStore settings is a button to [[#|Import MM Data]] click it and wait for the data to be imported.

Version 3.7.x was released on 09/03/21 you will not have any sales newer then Sep 3rd and because of that you will need to [[#Obtaining Guild History |obtainin Guild History]]. When complete you will have all the MM data that existed up until 09/03/21 and then all the sales that exist on the server. Then you will begin to accumulate data the same as you did with 3.5.x.

{{note: At this point you can also [[#|Import ATT Data]] if that is available to you.}}

You will also want to [[#|Import Pricing Data]] and [[#|Import ShoppingList Data]] as well.

If you chose to use the debuglogger slash commands and you did not encounter any errors then it is recommended that you type into chat <font class="tan"> /debuglogger level info</font> to avoid having unneeded debug messages from mods that use LibDebugLogger to output detailed debug messages. These detailed debug messages are not needed during normal operation.

At this point you will have to log out to the character screen and enable your preferred mods or use Circonians Addon Selector and restore the saved package of add-ons that you normally use.

{{note: If they are enabled, then disable the add-on ShoppingList, and each of the Master Merchant Data File MM00Data through Master Merchant Data File MM16Data files in the Libraries section to decrease load times}}. 

This will leave you with a gap in your sales from 09/03/21 until now. If that gap is too much for you then you can try to import your old LibHistoire information. To do that you will need to exit the game, backup your LibGuildStore data and your current LibHistoire data. Once you restore the copy of your old LibHistoire data that you moved to a safe place attempt to [[#|Refresh LibHistoire]] again. If you do not have better results then exit the game, restore your LibGuildStore and LibHistoire backups and you won't be able to use the old LibHistoire data.
[[se:]]

= Authors

Philgo68, Khaibit, dOpiate, sirinsidiator, Garkin, Aldanga, Sharlikran, Dolgubon

= Translators

mychaelo, svenpanne, tomkolp, mlsevero, Baertram, jupiter126, Otxics, Jakez
